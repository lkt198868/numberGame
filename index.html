<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>æ•°å­—æ±‚å’Œæ¸¸æˆ</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Arial', sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            color: #2c3e50;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #7f8c8d;
            font-size: 1.1rem;
        }

        .game-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 25px;
        }

        .target-display {
            font-size: 1.3rem;
            font-weight: bold;
            color: #e74c3c;
        }

        .current-sum {
            font-size: 1.2rem;
            font-weight: bold;
            color: #3498db;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
        }

        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #2980b9;
        }

        .check-btn {
            background-color: #27ae60;
        }

        .check-btn:hover {
            background-color: #229954;
        }

        .reset-btn {
            background-color: #e74c3c;
        }

        .reset-btn:hover {
            background-color: #c0392b;
        }

        .numbers-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .number-card {
            background-color: #f9f9f9;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            border: 2px solid #ddd;
            cursor: pointer;
            transition: all 0.3s;
            user-select: none;
        }

        .number-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .number-card.selected {
            background-color: #3498db;
            color: white;
            border-color: #2980b9;
            transform: scale(1.05);
        }

        .message {
            text-align: center;
            font-size: 1.2rem;
            font-weight: bold;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .message.success {
            background-color: #e8f8f5;
            color: #27ae60;
            border: 1px solid #27ae60;
        }

        .message.error {
            background-color: #fdedec;
            color: #e74c3c;
            border: 1px solid #e74c3c;
        }

        .message.info {
            background-color: #e3f2fd;
            color: #3498db;
            border: 1px solid #3498db;
        }

        /* èƒœåˆ©åŠ¨ç”» */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .winner {
            animation: pulse 0.5s ease-in-out 3;
        }

        /* æ’’èŠ±ç‰¹æ•ˆæ ·å¼ */
        .confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 9999;
            pointer-events: none;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #f00;
            animation: confetti-fall 3s linear forwards;
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        @media (max-width: 600px) {
            .numbers-container {
                grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .game-info {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>æ•°å­—æ±‚å’Œæ¸¸æˆ</h1>
            <p class="subtitle">é€‰æ‹©æ•°å­—ï¼Œä½¿å®ƒä»¬çš„å’Œç­‰äºç›®æ ‡æ•°å­—</p>
        </header>

        <div class="game-info">
            <div class="target-display">ç›®æ ‡æ•°å­—: <span id="targetNumber">0</span></div>
            <div class="current-sum">å½“å‰å’Œ: <span id="currentSum">0</span></div>
        </div>

        <div class="message info" id="message">é€‰æ‹©ä¸€äº›æ•°å­—ï¼Œä½¿å®ƒä»¬çš„å’Œç­‰äºç›®æ ‡æ•°å­—</div>

        <div class="controls">
            <button id="actionButton">æ£€æŸ¥ç­”æ¡ˆ</button>
        </div>

        <div class="numbers-container" id="numbersContainer">
            <!-- æ•°å­—å¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
        </div>
    </div>

    <!-- æ’’èŠ±ç‰¹æ•ˆå®¹å™¨ -->
    <div class="confetti-container" id="confettiContainer"></div>

    <script>
        // æ¸¸æˆçŠ¶æ€
        let targetNumber = 0;
        let numbers = [];
        let selectedNumbers = [];
        let gameWon = false;

        // æ’’èŠ±ç‰¹æ•ˆå‡½æ•°
        function createConfetti() {
            const confettiContainer = document.getElementById('confettiContainer');
            confettiContainer.innerHTML = ''; // æ¸…ç©ºä¹‹å‰çš„æ’’èŠ±
            
            // åˆ›å»ºå¤šç§é¢œè‰²çš„çº¸å±‘
            const colors = ['#f44336', '#e91e63', '#9c27b0', '#673ab7', '#3f51b5', 
                           '#2196f3', '#03a9f4', '#00bcd4', '#009688', '#4caf50',
                           '#8bc34a', '#cddc39', '#ffeb3b', '#ffc107', '#ff9800'];
            
            // åˆ›å»º100ä¸ªçº¸å±‘
            for (let i = 0; i < 100; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    
                    // éšæœºä½ç½®
                    const leftPosition = Math.random() * 100;
                    confetti.style.left = `${leftPosition}%`;
                    
                    // éšæœºé¢œè‰²
                    const colorIndex = Math.floor(Math.random() * colors.length);
                    confetti.style.backgroundColor = colors[colorIndex];
                    
                    // éšæœºå¤§å°
                    const size = Math.random() * 10 + 5;
                    confetti.style.width = `${size}px`;
                    confetti.style.height = `${size}px`;
                    
                    // éšæœºåŠ¨ç”»æ—¶é•¿
                    const duration = Math.random() * 2 + 2;
                    confetti.style.animationDuration = `${duration}s`;
                    
                    // éšæœºå»¶è¿Ÿ
                    const delay = Math.random() * 0.5;
                    confetti.style.animationDelay = `${delay}s`;
                    
                    confettiContainer.appendChild(confetti);
                    
                    // åŠ¨ç”»ç»“æŸåç§»é™¤å…ƒç´ 
                    setTimeout(() => {
                        confetti.remove();
                    }, (duration + delay) * 1000);
                }, i * 10); // æ¯ä¸ªçº¸å±‘å»¶è¿Ÿ10mså‡ºç°
            }
        }

        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            // é‡ç½®æ¸¸æˆçŠ¶æ€
            selectedNumbers = [];
            gameWon = false;
            
            // ç”Ÿæˆéšæœºæ•°å­—ç»„ (6-10ä¸ªæ•°å­—ï¼ŒèŒƒå›´1-9)
            const count = Math.floor(Math.random() * 5) + 6; // 6-10ä¸ªæ•°å­—
            numbers = [];
            
            for (let i = 0; i < count; i++) {
                numbers.push(Math.floor(Math.random() * 9) + 1); // 1-9çš„éšæœºæ•°
            }
            
            // ç¡®ä¿è‡³å°‘æœ‰ä¸€ä¸ªè§£ï¼šéšæœºé€‰æ‹©2-4ä¸ªæ•°å­—çš„å’Œä½œä¸ºç›®æ ‡ï¼Œä½†ä¸è¶…è¿‡10
            targetNumber = 0;
            const solutionIndices = [];
            
            // éšæœºé€‰æ‹©ä¸é‡å¤çš„ç´¢å¼•ï¼Œç›´åˆ°å’Œæ¥è¿‘ä½†ä¸è¶…è¿‡10
            let attempts = 0;
            while (targetNumber <= 5 && attempts < 20) { // ç¡®ä¿ç›®æ ‡æ•°å­—è‡³å°‘å¤§äº5ï¼Œä½†ä¸è¶…è¿‡10
                solutionIndices.length = 0; // æ¸…ç©ºæ•°ç»„
                targetNumber = 0;
                
                const solutionCount = Math.floor(Math.random() * 3) + 2; // 2-4ä¸ªæ•°å­—
                
                // éšæœºé€‰æ‹©ä¸é‡å¤çš„ç´¢å¼•
                while (solutionIndices.length < solutionCount) {
                    const index = Math.floor(Math.random() * numbers.length);
                    if (!solutionIndices.includes(index)) {
                        solutionIndices.push(index);
                        targetNumber += numbers[index];
                        
                        // å¦‚æœå’Œå·²ç»è¶…è¿‡10ï¼Œé‡æ–°å¼€å§‹
                        if (targetNumber > 10) {
                            break;
                        }
                    }
                }
                
                attempts++;
            }
            
            // å¦‚æœä»ç„¶æ²¡æœ‰åˆé€‚çš„ç›®æ ‡æ•°å­—ï¼Œä½¿ç”¨ç®€å•æ–¹æ³•
            if (targetNumber <= 5 || targetNumber > 10) {
                solutionIndices.length = 0;
                targetNumber = 0;
                
                // é€‰æ‹©å‰2-3ä¸ªæ•°å­—ï¼Œç¡®ä¿å’Œä¸è¶…è¿‡10
                const solutionCount = Math.floor(Math.random() * 2) + 2; // 2-3ä¸ªæ•°å­—
                for (let i = 0; i < solutionCount && i < numbers.length; i++) {
                    if (targetNumber + numbers[i] <= 10) {
                        solutionIndices.push(i);
                        targetNumber += numbers[i];
                    }
                }
            }
            
            // è®¾ç½®æœ€ç»ˆç›®æ ‡æ•°å­—
            // targetNumberå·²ç»åœ¨ä¸Šé¢è®¡ç®—å¥½äº†ï¼Œä¸éœ€è¦é¢å¤–èµ‹å€¼
            
            // æ˜¾ç¤ºæ¸¸æˆä¿¡æ¯
            document.getElementById('targetNumber').textContent = targetNumber;
            document.getElementById('currentSum').textContent = '0';
            
            // åˆ›å»ºæ•°å­—å¡ç‰‡
            const container = document.getElementById('numbersContainer');
            container.innerHTML = '';
            
            numbers.forEach((number, index) => {
                const card = document.createElement('div');
                card.className = 'number-card';
                card.textContent = number;
                card.dataset.index = index;
                card.dataset.value = number;
                
                // æ·»åŠ ç‚¹å‡»å’Œè§¦æ‘¸äº‹ä»¶å¤„ç†
                const handleCardInteraction = function() {
                    if (gameWon) return;
                    
                    if (this.classList.contains('selected')) {
                        // å–æ¶ˆé€‰æ‹©
                        this.classList.remove('selected');
                        const idx = selectedNumbers.indexOf(index);
                        if (idx > -1) {
                            selectedNumbers.splice(idx, 1);
                        }
                    } else {
                        // é€‰æ‹©æ•°å­—
                        this.classList.add('selected');
                        selectedNumbers.push(index);
                    }
                    
                    updateCurrentSum();
                };
                
                // æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼ˆæ¡Œé¢ç«¯ï¼‰
                card.addEventListener('click', handleCardInteraction);
                
                // æ·»åŠ è§¦æ‘¸äº‹ä»¶ï¼ˆç§»åŠ¨ç«¯ï¼‰
                card.addEventListener('touchstart', function(e) {
                    e.preventDefault(); // é˜²æ­¢è§¦æ‘¸äº‹ä»¶è§¦å‘ç‚¹å‡»äº‹ä»¶
                    handleCardInteraction.call(this);
                }, { passive: false });
                
                container.appendChild(card);
            });
            
            // é‡ç½®æ¶ˆæ¯
            updateMessage('é€‰æ‹©ä¸€äº›æ•°å­—ï¼Œä½¿å®ƒä»¬çš„å’Œç­‰äºç›®æ ‡æ•°å­—', 'info');
        }

        // æ›´æ–°å½“å‰å’Œ
        function updateCurrentSum() {
            let sum = 0;
            for (const index of selectedNumbers) {
                sum += numbers[index];
            }
            
            document.getElementById('currentSum').textContent = sum;
            
            // å¦‚æœå½“å‰å’Œç­‰äºç›®æ ‡æ•°å­—ï¼Œæ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
            // if (sum === targetNumber && selectedNumbers.length > 0) {
            //     // updateMessage('å¤ªæ£’äº†ï¼ä½ æ‰¾åˆ°äº†æ­£ç¡®çš„ç»„åˆï¼ç‚¹å‡»"æ£€æŸ¥ç­”æ¡ˆ"ç¡®è®¤', 'success');
            // } else 
            if (sum > targetNumber) {
                updateMessage('å½“å‰å’Œå·²ç»è¶…è¿‡ç›®æ ‡æ•°å­—ï¼Œè¯·å–æ¶ˆé€‰æ‹©ä¸€äº›æ•°å­—', 'error');
            } else {
                updateMessage('ç»§ç»­é€‰æ‹©æ•°å­—ï¼Œä½¿å®ƒä»¬çš„å’Œç­‰äºç›®æ ‡æ•°å­—', 'info');
            }
        }

        // æ›´æ–°æ¶ˆæ¯
        function updateMessage(text, type) {
            const messageEl = document.getElementById('message');
            messageEl.textContent = text;
            messageEl.className = `message ${type}`;
        }

        // å¤„ç†æŒ‰é’®ç‚¹å‡»
        function handleAction() {
            if (gameWon) {
                // å¦‚æœæ¸¸æˆå·²èƒœåˆ©ï¼Œç‚¹å‡»"å†æ¥ä¸€æ¬¡"åˆ™é‡ç½®æ¸¸æˆ
                resetGame();
            } else {
                // å¦åˆ™æ£€æŸ¥ç­”æ¡ˆ
                checkSolution();
            }
        }

        // æ£€æŸ¥ç­”æ¡ˆ
        function checkSolution() {
            let sum = 0;
            for (const index of selectedNumbers) {
                sum += numbers[index];
            }
            
            if (sum === targetNumber && selectedNumbers.length > 0) {
                // æˆåŠŸ
                gameWon = true;
                updateMessage('æ­å–œä½ ï¼ä½ èµ¢äº†ï¼ğŸ‰', 'success');
                
                // æ·»åŠ èƒœåˆ©åŠ¨ç”»
                document.querySelector('.container').classList.add('winner');
                
                // è§¦å‘æ’’èŠ±ç‰¹æ•ˆ
                createConfetti();
                
                // æ›´æ”¹æŒ‰é’®æ–‡æœ¬ä¸º"å†æ¥ä¸€æ¬¡"
                document.getElementById('actionButton').textContent = 'å†æ¥ä¸€æ¬¡';
                
                // ç§»é™¤åŠ¨ç”»ç±»
                setTimeout(() => {
                    document.querySelector('.container').classList.remove('winner');
                }, 1500);
            } else if (selectedNumbers.length === 0) {
                // å¤±è´¥ - æ²¡æœ‰é€‰æ‹©æ•°å­—
                updateMessage('è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªæ•°å­—', 'error');
            } else {
                // å¤±è´¥ - å’Œä¸ç›¸ç­‰
                updateMessage(`å½“å‰å’Œæ˜¯ ${sum}ï¼Œä¸ç­‰äºç›®æ ‡æ•°å­— ${targetNumber}ï¼Œè¯·ç»§ç»­å°è¯•`, 'error');
            }
        }

        // é‡ç½®æ¸¸æˆ
        function resetGame() {
            // é‡ç½®æŒ‰é’®æ–‡æœ¬
            document.getElementById('actionButton').textContent = 'æ£€æŸ¥ç­”æ¡ˆ';
            
            // åˆå§‹åŒ–æ–°æ¸¸æˆ
            initGame();
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–æ¸¸æˆ
        window.onload = function() {
            initGame();
            
            // ä¸ºæŒ‰é’®æ·»åŠ ç‚¹å‡»å’Œè§¦æ‘¸äº‹ä»¶ç›‘å¬å™¨
            const actionButton = document.getElementById('actionButton');
            
            // æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼ˆæ¡Œé¢ç«¯ï¼‰
            actionButton.addEventListener('click', handleAction);
            
            // æ·»åŠ è§¦æ‘¸äº‹ä»¶ï¼ˆç§»åŠ¨ç«¯ï¼‰
            actionButton.addEventListener('touchstart', function(e) {
                e.preventDefault(); // é˜²æ­¢è§¦æ‘¸äº‹ä»¶è§¦å‘ç‚¹å‡»äº‹ä»¶
                handleAction();
            }, { passive: false });
        };
    </script>
</body>
</html>